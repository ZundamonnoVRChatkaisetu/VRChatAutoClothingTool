# VRChat Auto Clothing Tool

VRChatアバター用の衣装を自動でサイズ調整するUnityエディタ拡張ツールです。Boothなどで販売されている特定のアバター向けの衣装を、別のアバターに合わせて自動調整することができます。

## 主な機能

- アバターと衣装のボーン構造を自動分析
- 衣装のサイズをアバターに合わせて自動調整
- ボーンマッピングの手動調整機能
- 調整前のプレビュー機能
- スケーリング設定のカスタマイズ
- VRChat特有のボーンやコンポーネントに対応

## 前提条件

- Unity 2019.4.31f1以上（VRChat SDK対応バージョン）
- VRChat SDK 3.0以上（オプション）

## インストール方法

### 方法1: UnityPackageをインポート

1. [Releases](https://github.com/ZundamonnoVRChatkaisetu/VRChatAutoClothingTool/releases)ページから最新の `.unitypackage` ファイルをダウンロード
2. Unityエディタで `Assets > Import Package > Custom Package` を選択
3. ダウンロードした `.unitypackage` ファイルを選択してインポート

### 方法2: リポジトリをクローン

1. このリポジトリをクローンまたはダウンロード
2. `Editor` フォルダをUnityプロジェクトの `Assets` フォルダ内にコピー

## 使い方

### 基本的な使い方

1. Unity メニューから `VRChat > Auto Clothing Tool` を選択
2. 「アバターと衣装の選択」セクションで、調整したいアバターと衣装のGameObjectを選択
3. 「ボーン構造を分析」ボタンをクリックして、ボーンの対応関係を自動検出
4. 必要に応じて「ボーンマッピング」セクションで手動調整
5. 「スケーリング設定」で衣装のサイズ調整パラメータを設定
6. 「プレビュー」ボタンで調整結果を確認（半透明表示）
7. 問題なければ「衣装を自動調整」ボタンをクリックして適用

### 詳細なステップ

#### 1. アバターと衣装の準備

- アバターと衣装の両方をシーンに配置
- アバターはT-poseまたはA-poseになっていることを確認
- 衣装も同様のポーズになっていることを確認（ポーズが大きく異なると調整が難しくなります）

#### 2. ボーン構造の分析

- 「ボーン構造を分析」ボタンをクリックすると、アバターと衣装のボーン構造が自動的に分析されます
- ボーン名やヒエラルキー構造から対応関係が推測されます
- 不明なボーンは手動でマッピングする必要があります

#### 3. ボーンマッピングの調整

- 「ボーンマッピング」セクションでは、自動検出されたボーンの対応関係が表示されます
- 不正確なマッピングや未設定のボーンは手動で調整できます
- 特に指のボーンや細かいパーツのボーンは手動調整が必要な場合があります

#### 4. スケーリング設定

- 「プロポーションを維持」オプションを有効にすると、XYZ軸で均等にスケーリングされます
- 無効にすると、各軸ごとに個別のスケール値を設定できます
- 一般的には 0.8 ～ 1.2 の範囲で調整すると良い結果が得られます

#### 5. プレビューと適用

- 「プレビュー」ボタンで現在の設定での調整結果を半透明表示で確認できます
- プレビューは30秒後に自動的に削除されます
- 「衣装を自動調整」ボタンをクリックすると、実際に衣装が調整されます
- 調整された衣装のメッシュは `Assets/AdjustedMeshes` フォルダに保存されます

## 高度な使用方法

### カスタムボーン対応

通常の人型アバター以外のボーン構造（例：獣人やロボットなど）を持つアバターに衣装を着せる場合は、手動でボーンマッピングを設定する必要があります。

1. 「ボーン構造を分析」後、未マッピングのボーンを確認
2. アバター側のボーンに対応する衣装側のボーンを手動で選択
3. 対応するボーンがない場合は、最も近い位置にあるボーンを選択

### 複数の衣装パーツの組み合わせ

複数の衣装パーツを組み合わせる場合は、各パーツごとに個別に調整することをお勧めします。

1. 最初のパーツを通常通り調整
2. 次のパーツを選択し、同じアバターに対して調整
3. すべてのパーツの調整が完了したら、必要に応じて手動で微調整

### 衣装のミラーリング

左右非対称の衣装を対称にする場合や、左右を入れ替える場合は、MeshUtilityクラスのMirrorMesh機能を使用できます。

```csharp
// 例：X軸でミラーリング
var renderer = clothingObject.GetComponentInChildren<SkinnedMeshRenderer>();
if (renderer != null && renderer.sharedMesh != null)
{
    Mesh mirroredMesh = MeshUtility.MirrorMesh(renderer.sharedMesh, new Vector3(1, 0, 0));
    // 必要に応じてマテリアルやテクスチャも調整
}
```

## トラブルシューティング

### 衣装が正しく調整されない

- アバターと衣装のポーズが大きく異なる場合は、まず同じポーズに揃える
- ボーンマッピングが正しいか確認（特に指や細かいパーツのボーン）
- スケーリング設定を調整（値を小さくしてから徐々に大きくする）

### ボーンマッピングが正しく検出されない

- アバターと衣装のボーン名が大きく異なる場合は手動マッピングが必要
- 非標準的なボーン構造の場合は、ボーンの位置や階層関係を考慮して手動で対応付け

### メッシュの変形が不自然

- 異なるポーズのアバターと衣装を調整すると不自然な変形が発生することがある
- ボーンウェイトが極端に異なる場合も不自然になる可能性がある
- 大きくスケールを変更すると問題が発生しやすい（0.7〜1.3の範囲内が望ましい）

## サポートとコントリビューション

- バグ報告や機能リクエストは [Issues](https://github.com/ZundamonnoVRChatkaisetu/VRChatAutoClothingTool/issues) にお願いします
- コントリビューションは Pull Request を通じて歓迎します
- 質問や議論は [Discussions](https://github.com/ZundamonnoVRChatkaisetu/VRChatAutoClothingTool/discussions) をご利用ください

## ライセンス

このプロジェクトは MIT ライセンスの下で公開されています。詳細は [LICENSE](LICENSE) ファイルをご覧ください。

## クレジット

- 開発: [ZundamonnoVRChatkaisetu](https://github.com/ZundamonnoVRChatkaisetu)
- 参考資料: [アバター改変方法（衣装のお着替え）](https://note.com/damakokoko/n/n6553ac2825a2)

---

**注意**: このツールは個人の責任で使用してください。衣装やアバターの著作権に関する規約を必ず確認し、遵守してください。衣装の作者が許可していない場合は、その衣装を別のアバターに使用しないでください。
